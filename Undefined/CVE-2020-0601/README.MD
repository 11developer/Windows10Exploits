**WORKING** ***MODE*** **...**


***CVE-2020-0601*** | Windows CryptoAPI Spoofing Vulnerability
```
Security Vulnerability
Published: 01/14/2020 | Last Updated : 01/16/2020
MITRE CVE-2020-0601
```
--------------------------------------------------------------------------

[![](https://github.com/nu11secur1ty/Windows10Exploits/blob/master/Undefined/CVE-2020-0601/logo/RE1Mu3b.png)](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0601)

--------------------------------------------------------------------------
```
On this page
Executive Summary
Exploitability Assessment
Security Updates
Mitigations
Workarounds
FAQ
Acknowledgements
Disclaimer
Revisions
```
--------------------------------------------------------------------------------------------
```
A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates.
An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, making it appear the file was from a trusted, legitimate source. The user would have no way of knowing the file was malicious, because the digital signature would appear to be from a trusted provider.
A successful exploit could also allow the attacker to conduct man-in-the-middle attacks and decrypt confidential information on user connections to the affected software.
The security update addresses the vulnerability by ensuring that Windows CryptoAPI completely validates ECC certificates.
```

# Based on 
- Ruby OpenSSL library https://github.com/ruby/openssl.

---------------------------------------------------------------------

# Usage
This ruby script `miamoto_musashi.rb` can be used to spoof a legit certificate authority and generat a certificate that will be considered valid for Windows computer affected by the CurveBall vulnerability.

---------------------------------------------------------------

You need to get a certificate comming from the certificate authority you want to spoof. Then, you can run the script with the following command : `ruby miamoto_musashi.rb -in=ca.crt -subj="/C=Bulgaria/ST=IleDeBulgaria/L=Sofia/O=nu11secur1ty" -out=cert_rb.p12 -exe=DoNotDebugMe.exe -sh -type=exe -sh | bash`

The script can be used to generate signed PE as well as TLS servers.

------------------------------------------------------------------
# Options

- -in : mandatory ; path to the trusted CA cert to spoof

- -out : mandatory ; path to store the generated certificate

- -type : mandatory ; can be 'exe' for code signing certificate or 'tls' for server and client authentication certificate

- -exe : optionnal ; name of the executable to sign

- -subj : optional ; subject of the generated cert

- -sh : flag optional ; return only the bash command needed to use the certificate (ex : command line to sign an executable)
