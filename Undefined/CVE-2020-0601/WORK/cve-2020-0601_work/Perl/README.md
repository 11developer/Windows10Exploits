cve-2020-0601-Perl
==================

![](https://github.com/nu11secur1ty/Windows10Exploits/blob/master/Undefined/CVE-2020-0601/WORK/cve-2020-0601_work/Perl/logo/RE1Mu3b.png)


This is the Perl version of the script main.rb published here:
    https://github.com/ollypwn/CVE-2020-0601
    
- Info: 


https://www.guru3d.com/news-story/microsoft-patches-crypt32-dll-vulnerability-that-allows-certificate-spoofing.html
https://kb.cert.org/vuls/id/849224/
https://media.defense.gov/2020/Jan/14/2002234275/-1/-1/0/CSA-WINDOWS-10-CRYPT-LIB-20190114.PDF


Need to install:
==================

```bash
cpan -i Crypt::OpenSSL::X509
cpan -i Crypt::PK::ECC
```
# Example of a number of the ECC Certificate:
![](https://github.com/nu11secur1ty/Windows10Exploits/blob/master/Undefined/CVE-2020-0601/WORK/cve-2020-0601_work/Perl/logo/microsoft-server-ecc-ssl-certificate-installation-10.jpg)

-------------------------------------------------------------------------------
# USAGE:

- Create EC certificate using OpenSSL
```bash
openssl ecparam -genkey -name prime256v1 -out key.pem
openssl req -new -sha256 -key key.pem -out csr.csr
openssl req -x509 -sha256 -days 365 -key key.pem -in csr.csr -out certificate.pem
openssl req -in csr.csr -text -noout | grep -i "Signature.*SHA256" && echo "All is well" || echo "This certificate will stop working in 2017! You must update OpenSSL to generate a widely-compatible certificate"
```
- Create spoof certificate
```bash
perl shibazuki.pl key.pem
```
- Output shuld be

```bash
```

