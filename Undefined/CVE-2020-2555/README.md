# CVE-2020-2555

- - - Remote Code Execution-Oracle's WebLogic Server Coherence-CVSS 3.0 Base Score 9.8

# Docker ENV
[https://hub.docker.com/u/nu11secur1ty/content/sub-e701660e-0b94-4782-83b2-16eb7ac98d29]

- Test on openSUSE leap 15

# Using this image

Accepting the terms of service
From the store.docker.com website accept Terms of Service for Oracle Database Enterprise Edition.

Login to Docker Store
Login to Docker Store with your credentials

```bash
$ docker login
```
Starting an Oracle Database Server instance
Starting an Oracle database server instance is as simple as executing

```bash
$ docker run -d -it --name <Oracle-DB> store/oracle/database-enterprise:12.2.0.1
```
where <Oracle-DB> is the name of the container and 12.2.0.1 is the Docker image tag.

The database server is ready to use when the STATUS field shows (healthy) in the output of docker ps.

# Connecting to the Database Server Container

The default password to connect to the database with sys user is Oradoc_db1.

Connecting from within the container
The database server can be connected to by executing SQL*Plus,
```bash
$ docker exec -it <Oracle-DB> bash -c "source /home/oracle/.bashrc; sqlplus /nolog"
```

# Connecting from outside the container

The database server exposes port 1521 for Oracle client connections over SQLNet protocol and port 5500 for Oracle XML DB. SQLPlus or any JDBC client can be used to connect to the database server from outside the container.

To connect from outside the container start the container with -P or -p option as,
```bash
$ docker run -d -it --name <Oracle-DB> -P store/oracle/database-enterprise:12.2.0.1
```
option -P indicates the ports are allocated by Docker. The mapped port can be discovered by executing
```bash
$ docker port <Oracle-DB> 1521/tcp -> 0.0.0.0:<mapped host port>
```
Using this <mapped host port> and <ip-address of host> create tnsnames.ora in the directory pointed to by environment variable TNS_ADMIN.

```
ORCLCDB=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=<ip-address of host>)(PORT=<mapped host port>))
    (CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=ORCLCDB.localdomain)))
ORCLPDB1=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=<ip-address> of host)(PORT=<mapped host port>))
    (CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=ORCLPDB1.localdomain)))
    
```
To connect from outside the container using SQL*Plus,

```bash
$ sqlplus sys/Oradoc_db1@ORCLCDB as sysdba
```

----------------------------------------------------------------------------------------


[https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-2555]

[https://www.nu11secur1ty.com/2020/03/cve-2020-2555.html]

[https://nvd.nist.gov/vuln/detail/CVE-2020-2555]

[https://www.oracle.com/security-alerts/cpujan2020.html]

- - - M0r#:

[https://vuldb.com/?id.148830]

[https://nsfocusglobal.com/oracle-coherence-deserialization-remote-code-execution-vulnerability-cve-2020-2555-threat-alert/]


- - - Description

Vulnerability in the Oracle Coherence product of Oracle Fusion Middleware (component: Caching,CacheStore,Invocation). Supported versions that are affected are 3.7.1.17, 12.1.3.0.0, 12.2.1.3.0 and 12.2.1.4.0. Easily exploitable vulnerability allows unauthenticated attacker with network access via T3 to compromise Oracle Coherence. Successful attacks of this vulnerability can result in takeover of Oracle Coherence. CVSS 3.0 Base Score 9.8 (Confidentiality, Integrity and Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

- - - - - - - Video from ***Zero Day Initiative*** 

https://www.youtube.com/watch?v=VzmZTYbm4Zw

- - - - - Usage:

```python
python CVE-2020-2555.py ip port test.ser
```


